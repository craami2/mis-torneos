<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="estilos.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="display: block; padding-top: 50px;">
    <h1 style="text-align:center; color:#00f2ff;">PANEL DE CONTROL</h1>
    <div class="panel">
        <h3>Añadir Torneo</h3>
        <input type="text" id="n" placeholder="Nombre del Evento">
        <input type="date" id="f">
        <button onclick="addE()">Publicar en Web</button>
    </div>
    <div class="panel">
        <h3>Actualizar Ranking</h3>
        <input type="text" id="un" placeholder="Usuario">
        <input type="number" id="up" placeholder="Puntos">
        <button onclick="addR()">Guardar Puntos</button>
    </div>
    <div class="panel">
        <h3>Registrar Ganador de Torneo</h3>
        <p style="font-size: 0.8rem; color: #888;">El ID del torneo lo ves en tu tabla 'eventos' de Supabase.</p>
        <input type="number" id="id_torneo" placeholder="ID del Torneo">
        <input type="text" id="nombre_ganador" placeholder="Nombre del Jugador">
        <input type="number" id="puntos_a_sumar" placeholder="Puntos ganados">
        <button onclick="guardarGanador()">Registrar y Sumar Puntos</button>
    </div>
    <script>
        const SUPABASE_URL = 'https://ekaiwrnvbpwaaoenwnnp.supabase.co'; 
        const SUPABASE_KEY = 'sb_publishable_YvgUfE8sAXfAUGvXMcNB4Q_aGC2GUMP';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function addE() {
            const { error } = await _supabase.from('eventos').insert([{ nombre: n.value, fecha: f.value }]);
            if(error) alert("Error: " + error.message);
            else alert("¡Evento publicado!");
        }
        async function addR() {
            const { error } = await _supabase.from('ranking').upsert([{ nombre: un.value, puntos: parseInt(up.value) }], {onConflict: 'nombre'});
            if(error) alert("Error: " + error.message);
            else alert("¡Puntos guardados!");
        }
    </script>
</body>
</html>



