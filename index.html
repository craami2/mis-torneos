<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Injective | Comunidad</title>
    <link rel="stylesheet" href="estilos.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <nav>
        <a onclick="show('cal')">Calendario</a>
        <a onclick="show('rank')">Ranking</a>
    </nav>
    <div class="container">
        <div id="cal" class="section active">
            <h2 style="color: #00f2ff">EVENTOS INJECTIVE</h2>
            <div class="grid-calendario" id="grid"></div>
        </div>
        <div id="rank" class="section">
            <h2 style="color: #00f2ff">LEADERBOARD</h2>
            <table>
                <thead><tr><th>Posici√≥n</th><th>Jugador</th><th>Puntos</th></tr></thead>
                <tbody id="tabla-body"></tbody>
            </table>
        </div>
    </div>
    <script>
        const SUPABASE_URL = 'https://ekaiwrnvbpwaaoenwnnp.supabase.co'; 
        const SUPABASE_KEY = 'sb_publishable_YvgUfe8sAXfAUGvXMcNB4Q_aGC2625292434313264426d4c67784f47514150534c453531';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        function show(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        async function cargar() {
            const { data: eventos } = await _supabase.from('eventos').select('*');
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            ['L','M','X','J','V','S','D'].forEach(d => grid.innerHTML += `<div class="dia-semana">${d}</div>`);
            for(let i=1; i<=31; i++) {
                let f = `2024-02-${i < 10 ? '0'+i : i}`;
                let evs = eventos?.filter(e => e.fecha === f) || [];
                grid.innerHTML += `<div class="dia"><div class="numero-dia">${i}</div>${evs.map(e => `<div class="evento-tag">${e.nombre}</div>`).join('')}</div>`;
            }
            const { data: ranks } = await _supabase.from('ranking').select('*').order('puntos', {ascending: false});
            document.getElementById('tabla-body').innerHTML = ranks?.map((r, i) => `<tr><td>#${i+1}</td><td>${r.nombre}</td><td>${r.puntos} PTS</td></tr>`).join('') || '';
        }
        cargar();
        setInterval(cargar, 5000);
    </script>
</body>
</html>
